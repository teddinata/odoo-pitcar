<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_cs_kpi">
        <t t-call="web.html_container">
            <div class="header">
                <h3 class="text-center">Customer Support KPI Report</h3>
                <h4 class="text-center"><t t-esc="period"/></h4>
                <p class="text-center">Generated on: <t t-esc="current_date"/></p>
            </div>
            <div class="article">
                <t t-foreach="cs_employees" t-as="employee_data">
                    <div style="page-break-inside: avoid; margin-bottom: 30px;">
                        <!-- Employee info section -->
                        <div class="row mt-3 mb-2">
                            <div class="col-6">
                                <h4><t t-esc="employee_data['employee']['name']"/></h4>
                                <p>Position: <t t-esc="employee_data['employee']['position']"/></p>
                                <p>Department: <t t-esc="employee_data['employee']['department']"/></p>
                            </div>
                            <div class="col-6 text-right">
                                <h5>Total Score: <t t-esc="'%.2f' % employee_data['summary']['total_score']"/></h5>
                                <p>Status: <t t-esc="employee_data['summary']['achievement_status']"/></p>
                            </div>
                        </div>
                        
                        <!-- KPI table -->
                        <table class="table table-sm table-bordered">
                            <thead>
                                <tr>
                                    <th style="width: 5%">No</th>
                                    <th style="width: 30%">KPI</th>
                                    <th style="width: 5%">Bobot</th>
                                    <th style="width: 5%">Target</th>
                                    <th style="width: 5%">Actual</th>
                                    <th style="width: 5%">Score</th>
                                    <th style="width: 45%">Measurement</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="employee_data['kpi_scores']" t-as="kpi">
                                    <tr>
                                        <td><t t-esc="kpi['no']"/></td>
                                        <td><t t-esc="kpi['name']"/></td>
                                        <td class="text-center"><t t-esc="'%.1f' % kpi['weight']"/></td>
                                        <td class="text-center"><t t-esc="'%.1f' % kpi['target']"/></td>
                                        <td class="text-center"><t t-esc="'%.1f' % kpi['actual']"/></td>
                                        <td class="text-center"><t t-esc="'%.2f' % kpi['weighted_score']"/></td>
                                        <td><t t-esc="kpi['measurement']"/></td>
                                    </tr>
                                </t>
                                <!-- Summary row -->
                                <tr class="font-weight-bold">
                                    <td colspan="2">TOTAL</td>
                                    <td class="text-center"><t t-esc="'%.1f' % employee_data['summary']['total_weight']"/></td>
                                    <td colspan="2"></td>
                                    <td class="text-center"><t t-esc="'%.2f' % employee_data['summary']['total_score']"/></td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div style="page-break-after: always;"></div>
                </t>
            </div>
        </t>
    </template>
</odoo>